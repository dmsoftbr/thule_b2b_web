import{j as e,r as i,g as D,t as g,h as C,l as S,e as w}from"./index-C-yn2kxu.js";import{A as y}from"./app-page-header-B97b6w1v.js";import{S as b}from"./server-table-OrazAZj6.js";import{B as j}from"./index-Cj-kxx9Z.js";import{D as N,a as T,b as I,c as f,d as v}from"./dropdown-menu-3YsRMfS2.js";import{M as A}from"./menu-DLE56LUh.js";import{S as k}from"./square-pen-C5Wms97H.js";import{T as M}from"./trash-DuwzUJ5T.js";import{L as E}from"./list-checks-BXCpj9to.js";import{T as F}from"./tree-checkbox-D0r5Lhfv.js";import{D as G,a as L,b as z,c as P,d as B,f as V}from"./dialog-o4W0LXdK.js";import{I as $}from"./input-Dr2m_CVc.js";import{L as O}from"./label-PvIEZhsH.js";import{L as q}from"./loader-circle-BV1pYLGQ.js";import"./app-tooltip-1VY1K540.js";import"./index-D5w6tM8m.js";import"./Combination-BJv6NSEb.js";import"./index-z0-V-lU6.js";import"./index-BoUYBFaC.js";import"./index-DRosYylb.js";import"./select-BqrgrOas.js";import"./index-Cap87g99.js";import"./chevron-down-lpqsW9lE.js";import"./index-Dtymrjkl.js";import"./search-8CyYJVSP.js";import"./funnel-CSCaqyL5.js";import"./chevron-left-DklgzkMt.js";import"./chevron-right-CCWYEIpL.js";import"./square-oq4V5Qgv.js";import"./index-C8Qjzrxd.js";const H=({fnEdit:t,fnDelete:r,fnDetails:s})=>[{key:"id",dataIndex:"id",title:"Código",renderItem:a=>e.jsx("span",{className:"font-semibold text-blue-600 ",children:a.id}),sortable:!0},{key:"name",dataIndex:"name",title:"Nome",renderItem:a=>e.jsx("span",{children:a.name}),sortable:!0},{key:"actions",dataIndex:"id",title:"Ações",className:"w-[120px]",renderItem:a=>e.jsx("div",{className:"flex",children:e.jsxs(N,{children:[e.jsx(T,{asChild:!0,children:e.jsx(j,{size:"sm",variant:"secondary",children:e.jsx(A,{className:"size-4"})})}),e.jsxs(I,{align:"end",className:"",children:[e.jsxs(f,{onClick:()=>t(a),children:[e.jsx(k,{className:"size-4"}),"Alterar"]}),e.jsx(v,{}),e.jsxs(f,{onClick:()=>r(a),children:[e.jsx(M,{className:"size-4"}),"Excluir"]}),e.jsx(v,{}),e.jsxs(f,{onClick:()=>s(a),children:[e.jsx(E,{className:"size-4"}),"Detalhe"]})]})]})})}],R=[],U=async(t,r)=>{try{const s={salesGroupId:t,selectedPathIds:r};await D.post(`/registrations/sales-groups/grid/${t}`,s)}catch(s){console.log(s),g.error(C(s))}},Y=({groupData:t,isOpen:r,onClose:s})=>{const[a,d]=i.useState([]),[n,l]=i.useState(!1),[m,p]=i.useState([]);async function u(){try{l(!0),await U(t.id,a),g.success("Detalhamento gravado com sucesso!")}catch(o){g.error(C(o))}finally{l(!1)}}const x=async()=>{const{data:o}=await D.get(`/registrations/sales-groups/grid/${t.id}`);p(o)},h=i.useCallback(o=>{console.log("SELCT",o),d(o)},[]);return i.useEffect(()=>{r&&x()},[r]),e.jsx(G,{open:r,onOpenChange:s,children:e.jsxs(L,{className:"min-w-fit md:min-w-[70%]",children:[e.jsxs(z,{children:[e.jsx(P,{children:"Detalhamento do Grupo de Vendas"}),e.jsx(B,{})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx(O,{children:"Grupo de Vendas"}),e.jsx($,{readOnly:!0,value:t.id})]}),e.jsx("div",{children:e.jsx(F,{data:m??R,onSelectionChange:h,className:"shadow-sm",searchable:!0,searchPlaceholder:"Buscar...",showSelectAllButtons:!0})})]}),e.jsxs(V,{className:"!justify-between",children:[e.jsx("div",{className:"text-xs bg-amber-200 rounded py-1 px-2 w-fit h-fit items-center",children:"Tipo Item / Família Comercial / Grupo de Estoque / Família Material / Características / Tipo Produto / Grupo de Item"}),e.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[e.jsx(j,{disabled:n,onClick:()=>u(),children:n?e.jsxs("div",{children:[e.jsx(q,{className:"size-3 animate-spin"}),"Gravando..."]}):e.jsx("span",{children:"Gravar"})}),e.jsx(j,{onClick:s,variant:"secondary",children:"Fechar"})]})]})]})})},_=[{id:"id",label:"Código"},{id:"name",label:"Nome"}],be=function(){const{showAppDialog:r}=S(),[s,a]=i.useState(new Date().valueOf()),[d,n]=i.useState(!1),[l,m]=i.useState(null),p=w(),u=()=>{p({to:"/registrations/sales-group/new-group"})},x=async c=>{p({to:`/registrations/sales-group/${c.id}`})},h=async c=>{await r({title:"Atenção",message:"Ao excluir este Grupo, a configuração dele e o vínculo com clientes também serão eliminados. Continua?",type:"confirm",buttons:[{text:"Excluir",value:!0,variant:"danger"},{text:"Cancelar",value:!1,variant:"secondary"}]})&&(await D.delete(`/registrations/sales-groups/${c.id}`),a(new Date().valueOf()))},o=async c=>{m(c),n(!0)};return e.jsxs(y,{titleSlot:"Grupos de Venda",children:[e.jsx("div",{className:"p-2",children:e.jsx(b,{onAdd:()=>u(),defaultSearchField:"name",defaultSortFieldDataIndex:"name",searchFields:_,columns:H({fnDelete:h,fnEdit:x,fnDetails:o}),dataUrl:"/registrations/sales-groups/list-paged"},s)}),d&&l&&e.jsx(Y,{groupData:l,isOpen:d,onClose:()=>{n(!1),m(null)}})]})};export{be as component};
