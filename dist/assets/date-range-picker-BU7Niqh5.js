import{R as X,r as m,j as t}from"./index-C-yn2kxu.js";import{u as W,P as _,c as M,B as H}from"./index-Cj-kxx9Z.js";import{P as G,a as J,b as Q}from"./popover-D4FvDG7G.js";import{C as Z}from"./calendar-D1sFkhYR.js";import{L as ee}from"./label-PvIEZhsH.js";import{C as te,S as se,a as ne,b as re,c as ae,d as oe}from"./select-BqrgrOas.js";import{b as ce,c as le,a as ie}from"./index-D5w6tM8m.js";import{u as de,C as ue}from"./index-Cap87g99.js";import{u as me}from"./index-BoUYBFaC.js";import{C as fe}from"./chevron-down-lpqsW9lE.js";import{p as he}from"./pt-BR-ruWP6cy_.js";const R=({value:l,onChange:d})=>{const[o,u]=X.useState(()=>{const r=l?new Date(l):new Date;return{day:r.getDate(),month:r.getMonth()+1,year:r.getFullYear()}}),g=m.useRef(null),k=m.useRef(null),p=m.useRef(null);m.useEffect(()=>{const r=l?new Date(l):new Date;u({day:r.getDate(),month:r.getMonth()+1,year:r.getFullYear()})},[l]);const y=(r,e)=>{if(r==="day"&&(e<1||e>31)||r==="month"&&(e<1||e>12)||r==="year"&&(e<1e3||e>9999))return!1;const s={...o,[r]:e},x=new Date(s.year,s.month-1,s.day);return x.getFullYear()===s.year&&x.getMonth()+1===s.month&&x.getDate()===s.day},D=r=>e=>{const s=e.target.value?Number(e.target.value):"",x=typeof s=="number"&&y(r,s),v={...o,[r]:s};u(v),x&&d(new Date(v.year,v.month-1,v.day))},w=m.useRef(o),h=r=>e=>{if(!e.target.value){u(w.current);return}const s=Number(e.target.value);y(r,s)?w.current={...o,[r]:s}:u(w.current)},c=r=>e=>{if(!(e.metaKey||e.ctrlKey)){if(!/^[0-9]$/.test(e.key)&&!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Delete","Tab","Backspace","Enter"].includes(e.key)){e.preventDefault();return}if(e.key==="ArrowUp"){e.preventDefault();let s={...o};r==="day"&&(o[r]===new Date(o.year,o.month,0).getDate()?(s={...s,day:1,month:o.month%12+1},s.month===1&&(s.year+=1)):s.day+=1),r==="month"&&(o[r]===12?s={...s,month:1,year:o.year+1}:s.month+=1),r==="year"&&(s.year+=1),u(s),d(new Date(s.year,s.month-1,s.day))}else if(e.key==="ArrowDown"){e.preventDefault();let s={...o};r==="day"&&(o[r]===1?(s.month-=1,s.month===0&&(s.month=12,s.year-=1),s.day=new Date(s.year,s.month,0).getDate()):s.day-=1),r==="month"&&(o[r]===1?s={...s,month:12,year:o.year-1}:s.month-=1),r==="year"&&(s.year-=1),u(s),d(new Date(s.year,s.month-1,s.day))}e.key==="ArrowRight"?(e.currentTarget.selectionStart===e.currentTarget.value.length||e.currentTarget.selectionStart===0&&e.currentTarget.selectionEnd===e.currentTarget.value.length)&&(e.preventDefault(),r==="month"&&p.current?.focus(),r==="day"&&g.current?.focus()):e.key==="ArrowLeft"&&(e.currentTarget.selectionStart===0||e.currentTarget.selectionStart===0&&e.currentTarget.selectionEnd===e.currentTarget.value.length)&&(e.preventDefault(),r==="month"&&k.current?.focus(),r==="year"&&g.current?.focus())}};return t.jsxs("div",{className:"flex border rounded-lg items-center text-sm px-1",children:[t.jsx("input",{type:"text",ref:k,max:31,maxLength:2,value:o.day.toString(),onChange:D("day"),onKeyDown:c("day"),onFocus:r=>{window.innerWidth>1024&&r.target.select()},onBlur:h("day"),className:"p-0 outline-none w-7 border-none text-center",placeholder:"D"}),t.jsx("span",{className:"opacity-20 -mx-px",children:"/"}),t.jsx("input",{type:"text",ref:g,max:12,maxLength:2,value:o.month.toString(),onChange:D("month"),onKeyDown:c("month"),onFocus:r=>{window.innerWidth>1024&&r.target.select()},onBlur:h("month"),className:"p-0 outline-none w-6 border-none text-center",placeholder:"M"}),t.jsx("span",{className:"opacity-20 -mx-px",children:"/"}),t.jsx("input",{type:"text",ref:p,max:9999,maxLength:4,value:o.year.toString(),onChange:D("year"),onKeyDown:c("year"),onFocus:r=>{window.innerWidth>1024&&r.target.select()},onBlur:h("year"),className:"p-0 outline-none w-12 border-none text-center",placeholder:"YYYY"})]})};R.displayName="DateInput";var T="Switch",[ge,Be]=le(T),[pe,xe]=ge(T),V=m.forwardRef((l,d)=>{const{__scopeSwitch:o,name:u,checked:g,defaultChecked:k,required:p,disabled:y,value:D="on",onCheckedChange:w,form:h,...c}=l,[r,e]=m.useState(null),s=W(d,b=>e(b)),x=m.useRef(!1),v=r?h||!!r.closest("form"):!0,[S,N]=ce({prop:g,defaultProp:k??!1,onChange:w,caller:T});return t.jsxs(pe,{scope:o,checked:S,disabled:y,children:[t.jsx(_.button,{type:"button",role:"switch","aria-checked":S,"aria-required":p,"data-state":$(S),"data-disabled":y?"":void 0,disabled:y,value:D,...c,ref:s,onClick:ie(l.onClick,b=>{N(B=>!B),v&&(x.current=b.isPropagationStopped(),x.current||b.stopPropagation())})}),v&&t.jsx(K,{control:r,bubbles:!x.current,name:u,value:D,checked:S,required:p,disabled:y,form:h,style:{transform:"translateX(-100%)"}})]})});V.displayName=T;var U="SwitchThumb",O=m.forwardRef((l,d)=>{const{__scopeSwitch:o,...u}=l,g=xe(U,o);return t.jsx(_.span,{"data-state":$(g.checked),"data-disabled":g.disabled?"":void 0,...u,ref:d})});O.displayName=U;var we="SwitchBubbleInput",K=m.forwardRef(({__scopeSwitch:l,control:d,checked:o,bubbles:u=!0,...g},k)=>{const p=m.useRef(null),y=W(p,k),D=de(o),w=me(d);return m.useEffect(()=>{const h=p.current;if(!h)return;const c=window.HTMLInputElement.prototype,e=Object.getOwnPropertyDescriptor(c,"checked").set;if(D!==o&&e){const s=new Event("click",{bubbles:u});e.call(h,o),h.dispatchEvent(s)}},[D,o,u]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o,...g,tabIndex:-1,ref:y,style:{...g.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});K.displayName=we;function $(l){return l?"checked":"unchecked"}var ye=V,De=O;function ve({className:l,...d}){return t.jsx(ye,{"data-slot":"switch",className:M("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",l),...d,children:t.jsx(De,{"data-slot":"switch-thumb",className:M("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const P=(l,d="en-us")=>l.toLocaleDateString(d,{month:"numeric",day:"numeric",year:"numeric"}),j=l=>{if(typeof l=="string"){const d=l.split("-").map(u=>parseInt(u,10));return new Date(d[0],d[1]-1,d[2])}else return l},E=[{name:"today",label:"Hoje"},{name:"yesterday",label:"Ontem"},{name:"last7",label:"Últimos 7 dias"},{name:"last14",label:"Últimos 14 dias"},{name:"last30",label:"Últimos 30 dias"},{name:"thisWeek",label:"Esta Semana"},{name:"lastWeek",label:"Última Semana"},{name:"thisMonth",label:"Este Mês"},{name:"lastMonth",label:"Último Mês"}],be=({initialDateFrom:l=new Date(new Date().setHours(0,0,0,0)),initialDateTo:d,initialCompareFrom:o,initialCompareTo:u,onUpdate:g,align:k="end",locale:p="en-US",showCompare:y=!0,disabled:D=!1})=>{const[w,h]=m.useState(!1),[c,r]=m.useState({from:j(l),to:j(d||l)}),[e,s]=m.useState(o?{from:new Date(new Date(o).setHours(0,0,0,0)),to:u?new Date(new Date(u).setHours(0,0,0,0)):new Date(new Date(o).setHours(0,0,0,0))}:void 0),x=m.useRef(void 0),v=m.useRef(void 0),[S,N]=m.useState(void 0),[b,B]=m.useState(typeof window<"u"?window.innerWidth<960:!1);m.useEffect(()=>{const n=()=>{B(window.innerWidth<960)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]);const L=n=>{const i=E.find(({name:A})=>A===n);if(!i)throw new Error(`Unknown date range preset: ${n}`);const a=new Date,f=new Date,C=a.getDate()-a.getDay();switch(i.name){case"today":a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"yesterday":a.setDate(a.getDate()-1),a.setHours(0,0,0,0),f.setDate(f.getDate()-1),f.setHours(23,59,59,999);break;case"last7":a.setDate(a.getDate()-6),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"last14":a.setDate(a.getDate()-13),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"last30":a.setDate(a.getDate()-29),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"thisWeek":a.setDate(C),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"lastWeek":a.setDate(a.getDate()-7-a.getDay()),f.setDate(f.getDate()-f.getDay()-1),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"thisMonth":a.setDate(1),a.setHours(0,0,0,0),f.setHours(23,59,59,999);break;case"lastMonth":a.setMonth(a.getMonth()-1),a.setDate(1),a.setHours(0,0,0,0),f.setDate(0),f.setHours(23,59,59,999);break}return{from:a,to:f}},Y=n=>{const i=L(n);if(r(i),e){const a={from:new Date(i.from.getFullYear()-1,i.from.getMonth(),i.from.getDate()),to:i.to?new Date(i.to.getFullYear()-1,i.to.getMonth(),i.to.getDate()):void 0};s(a)}},q=()=>{for(const n of E){const i=L(n.name),a=new Date(c.from);a.setHours(0,0,0,0);const f=new Date(i.from.setHours(0,0,0,0)),C=new Date(c.to??0);C.setHours(0,0,0,0);const A=new Date(i.to?.setHours(0,0,0,0)??0);if(a.getTime()===f.getTime()&&C.getTime()===A.getTime()){N(n.name);return}}N(void 0)},z=()=>{r({from:typeof l=="string"?j(l):l,to:d?typeof d=="string"?j(d):d:typeof l=="string"?j(l):l}),s(o?{from:typeof o=="string"?j(o):o,to:u?typeof u=="string"?j(u):u:typeof o=="string"?j(o):o}:void 0)};m.useEffect(()=>{q()},[c]);const F=({preset:n,label:i,isSelected:a})=>t.jsx(H,{className:M(a&&"pointer-events-none"),variant:"ghost",onClick:()=>{Y(n)},children:t.jsxs(t.Fragment,{children:[t.jsx("span",{className:M("pr-2 opacity-0",a&&"opacity-70"),children:t.jsx(ue,{width:18,height:18})}),i]})}),I=(n,i)=>!n||!i?n===i:n.from.getTime()===i.from.getTime()&&(!n.to||!i.to||n.to.getTime()===i.to.getTime());return m.useEffect(()=>{w&&(x.current=c,v.current=e)},[w]),t.jsxs(G,{modal:!0,open:w,onOpenChange:n=>{n||z(),h(n)},children:[t.jsx(J,{asChild:!0,children:t.jsxs(H,{variant:"outline",disabled:D,children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"py-1",children:t.jsx("div",{children:`${P(c.from,p)}${c.to!=null?" até "+P(c.to,p):""}`})}),e!=null&&t.jsx("div",{className:"opacity-60 text-xs -mt-1",children:t.jsxs(t.Fragment,{children:["vs. ",P(e.from,p),e.to!=null?` - ${P(e.to,p)}`:""]})})]}),t.jsx("div",{className:"pl-1 opacity-60 -mr-2 scale-125",children:w?t.jsx(te,{width:24}):t.jsx(fe,{width:24})})]})}),t.jsxs(Q,{align:k,className:"w-auto",children:[t.jsxs("div",{className:"flex py-2",children:[t.jsx("div",{className:"flex",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row gap-2 px-3 justify-end items-center lg:items-start pb-4 lg:pb-0",children:[y&&t.jsxs("div",{className:"flex items-center space-x-2 pr-4 py-1",children:[t.jsx(ve,{defaultChecked:!!e,onCheckedChange:n=>{n?(c.to||r({from:c.from,to:c.from}),s({from:new Date(c.from.getFullYear(),c.from.getMonth(),c.from.getDate()-365),to:c.to?new Date(c.to.getFullYear()-1,c.to.getMonth(),c.to.getDate()):new Date(c.from.getFullYear()-1,c.from.getMonth(),c.from.getDate())})):s(void 0)},id:"compare-mode"}),t.jsx(ee,{htmlFor:"compare-mode",children:"Compare"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(R,{value:c.from,onChange:n=>{const i=c.to==null||n>c.to?n:c.to;r(a=>({...a,from:n,to:i}))}}),t.jsx("div",{className:"py-1",children:"-"}),t.jsx(R,{value:c.to,onChange:n=>{const i=n<c.from?n:c.from;r(a=>({...a,from:i,to:n}))}})]}),e!=null&&t.jsxs("div",{className:"flex gap-2",children:[t.jsx(R,{value:e?.from,onChange:n=>{if(e){const i=e.to==null||n>e.to?n:e.to;s(a=>({...a,from:n,to:i}))}else s({from:n,to:new Date})}}),t.jsx("div",{className:"py-1",children:"-"}),t.jsx(R,{value:e?.to,onChange:n=>{if(e&&e.from){const i=n<e.from?n:e.from;s({...e,from:i,to:n})}}})]})]})]}),b&&t.jsxs(se,{defaultValue:S,onValueChange:n=>{Y(n)},children:[t.jsx(ne,{className:"w-[180px] mx-auto mb-2",children:t.jsx(re,{placeholder:"Select..."})}),t.jsx(ae,{children:E.map(n=>t.jsx(oe,{value:n.name,children:n.label},n.name))})]}),t.jsx("div",{children:t.jsx(Z,{locale:he,mode:"range",onSelect:n=>{n?.from!=null&&r({from:n.from,to:n?.to})},selected:c,numberOfMonths:b?1:2,defaultMonth:new Date(new Date().setMonth(new Date().getMonth()-(b?0:1)))})})]})}),!b&&t.jsx("div",{className:"flex flex-col items-end gap-1 pr-2 pl-6 pb-6",children:t.jsx("div",{className:"flex w-full flex-col items-end gap-1 pr-2 pl-6 pb-6",children:E.map(n=>t.jsx(F,{preset:n.name,label:n.label,isSelected:S===n.name},n.name))})})]}),t.jsxs("div",{className:"flex justify-end gap-2 py-2 pr-4",children:[t.jsx(H,{onClick:()=>{h(!1),z()},variant:"ghost",children:"Cancelar"}),t.jsx(H,{onClick:()=>{h(!1),(!I(c,x.current)||!I(e,v.current))&&g?.({range:c,rangeCompare:e})},children:"Selecionar"})]})]})]})};be.displayName="DateRangePicker";export{be as D};
