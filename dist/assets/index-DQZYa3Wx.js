import{j as e,r as o,g as u,t as x,h as S,ac as v,e as y}from"./index-C-yn2kxu.js";import{A as D}from"./app-page-header-B97b6w1v.js";import{S as C}from"./server-table-OrazAZj6.js";import{B as m}from"./index-Cj-kxx9Z.js";import{u as b}from"./useQuery-BEMaX6S8.js";import{T as w}from"./trash-DuwzUJ5T.js";import{D as G,a as A,b as k,c as T,d as V,f as O}from"./dialog-o4W0LXdK.js";import{S as $,c as E}from"./search-combo-DoY-PKU3.js";import"./input-Dr2m_CVc.js";import"./app-tooltip-1VY1K540.js";import"./index-D5w6tM8m.js";import"./Combination-BJv6NSEb.js";import"./index-z0-V-lU6.js";import"./index-BoUYBFaC.js";import"./index-DRosYylb.js";import"./select-BqrgrOas.js";import"./index-Cap87g99.js";import"./chevron-down-lpqsW9lE.js";import"./index-Dtymrjkl.js";import"./search-8CyYJVSP.js";import"./funnel-CSCaqyL5.js";import"./loader-circle-BV1pYLGQ.js";import"./chevron-left-DklgzkMt.js";import"./chevron-right-CCWYEIpL.js";import"./index-C8Qjzrxd.js";import"./command-DF-KUbv3.js";import"./popover-D4FvDG7G.js";import"./chevrons-up-down-DXmsIWP1.js";const F=({fnDelete:i})=>[{key:"groupId",dataIndex:"groupId",title:"Grupo de Venda"},{key:"actions",dataIndex:"groupId",title:"Ações",renderItem:n=>e.jsx("div",{children:e.jsx(m,{variant:"destructive",onClick:()=>i(n),children:e.jsx(w,{className:"size-4"})})})}],N=({isOpen:i,customerId:n,onClose:r})=>{const[d,l]=o.useState(""),[a,p]=o.useState([]),[c,g]=o.useState(new Date().valueOf()),[h,t]=o.useState(!1),j=async()=>{const s={customerId:n,groupId:d};try{await u.post("/registrations/customer-sales-group",s),x.success("Grupo de Venda Vinculada"),r(!0)}catch(f){x.error(S(f))}},I=async()=>{t(!0);try{const{data:s}=await u.get("/registrations/sales-groups/all"),f=E(s,"id","id",!1);p(f)}catch(s){x.error(S(s))}finally{t(!1)}};return o.useEffect(()=>{I(),g(new Date().valueOf())},[i]),e.jsx(G,{open:i,onOpenChange:r,children:e.jsxs(A,{children:[e.jsxs(k,{children:[e.jsx(T,{children:"Adicionar Grupo de Venda"}),e.jsx(V,{})]}),e.jsx("div",{children:e.jsx($,{onChange:s=>l(s),staticItems:a,disabled:h},c)}),e.jsxs(O,{children:[e.jsx(m,{variant:"green",onClick:()=>j(),children:"Adicionar"}),e.jsx(m,{variant:"secondary",onClick:()=>r(!1),children:"Cancelar"})]})]})})},ue=function(){const[n,r]=o.useState(new Date().valueOf()),[d,l]=o.useState(!1),{customerId:a}=v({from:"/_app/registrations/customers/$customerId/sales-group/"}),p=y(),{data:c}=b({queryKey:["customer-id",a],queryFn:async()=>{const{data:t}=await u.get(`/registrations/customers/id/${a}`);return t},enabled:!!a}),g=()=>{l(!0)},h=async t=>{await u.delete(`/registrations/customer-sales-group/${t.customerId}/${t.groupId}`),r(new Date().valueOf())};return e.jsxs(D,{titleSlot:`Grupos de Venda do Cliente: ${a} - ${c?.abbreviation}`,children:[e.jsx("div",{className:"max-w-lg ml-auto mr-auto mt-2",children:e.jsx(C,{onAdd:()=>g(),columns:F({fnDelete:h}),defaultSearchField:"groupId",searchFields:[{id:"groupId",label:"Grupo de Venda"}],dataUrl:"/registrations/customer-sales-group/list-paged",additionalInfo:{customerId:a}},n)}),e.jsx("div",{className:"my-4 max-w-lg ml-auto mr-auto",children:e.jsx(m,{onClick:()=>p({to:"/registrations/customers"}),children:"Voltar p/Lista de Clientes"})}),d&&e.jsx(N,{isOpen:d,onClose:t=>{t&&r(new Date().valueOf()),l(!1)},customerId:c?.id??-1})]})};export{ue as component};
