import{j as r,r as a,g as Z}from"./index-C-yn2kxu.js";import{S as _,c as y,a as P,B as z}from"./index-Cj-kxx9Z.js";import{C as q,a as O,b as E,c as V,d as ee,e as se}from"./command-DF-KUbv3.js";import{P as re,a as te,b as ae}from"./popover-D4FvDG7G.js";import{C as ne}from"./chevrons-up-down-DXmsIWP1.js";import{C as oe}from"./index-Cap87g99.js";const le=P("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ce({className:i,variant:t,asChild:u=!1,...v}){const m=u?_:"span";return r.jsx(m,{"data-slot":"badge",className:y(le({variant:t}),i),...v})}function ie(i,t,u,v=!1){const m=[];if(!i)return m;const N=l=>typeof u=="string"?v?`${l[t]} - ${l[u]}`:`${l[u]}`:u(l);return i.map(l=>{const c=`${l[t]}`,x=N(l);m.push({value:c,label:x,keywords:[c,x],extra:l})}),m}const ve=({staticItems:i=[],apiEndpoint:t,disabled:u=!1,queryStringName:v="search",placeholder:m="Selecione um item...",searchPlaceholder:N="Buscar item...",noResultsText:l="Nenhum resultado encontrado.",multipleSelect:c=!1,defaultValue:x,onChange:h,onSelectOption:g,className:R,showValueInSelectedItem:p=!1,showSelectButtons:U=!1,valueProp:$,labelProp:S,deSelectOnClick:B=!1,selectFirstOptionOnLoad:G=!1})=>{const[T,I]=a.useState(!1),[d,A]=a.useState(i),[L,D]=a.useState(!1),[C,H]=a.useState(""),[n,w]=a.useState([]),k=a.useCallback(async(e="")=>{if(t){if(!$||!S){console.error("valueProp e labelProp são obrigatórios ao usar API");return}D(!0);try{const s=t.includes("?")?"&":"?",o=e?`${t}${s}${v}=${encodeURIComponent(e)}`:t,{data:j}=await Z(o),f=ie(j,$,S,!1);if(A(f),G&&f.length>0){const Y=f[0];M(Y.value)}}catch(s){console.error("Erro ao buscar itens:",s),A([])}finally{D(!1)}}},[t,v,$,S]);a.useEffect(()=>{t&&k()},[t,k]),a.useEffect(()=>{!t&&i.length>0&&A(i)},[i,t]);const F=a.useCallback(e=>{if(!e||d.length===0)return[];if(Array.isArray(e))return e.length===0?[]:typeof e[0]=="string"?d.filter(s=>e.includes(s.value)):e;if(typeof e=="object"&&"value"in e)return[e];if(typeof e=="string"){const s=d.find(o=>o.value===e);return s?[s]:[]}return[]},[d]);a.useEffect(()=>{if(x!==void 0){const e=F(x);w(e)}},[x,F]);const J=a.useCallback(e=>{H(e),t&&k(e)},[t,k]),b=a.useMemo(()=>{if(t||!C)return d;const e=C.toLowerCase();return d.filter(s=>s.label.toLowerCase().includes(e)||s.value.toLowerCase().includes(e)||s.keywords?.some(o=>o.toLowerCase().includes(e)))},[t,d,C]),K=a.useCallback(e=>n.some(s=>s.value===e),[n]),M=a.useCallback(e=>{const s=d.find(j=>j.value===e);if(!s)return;let o=[];if(c)n.some(f=>f.value===e)?o=n.filter(f=>f.value!==e):o=[...n,s],h?.(e);else{const j=n.some(f=>f.value===e);B&&j?(o=[],h?.("")):(o=[s],h?.(e)),I(!1)}w(o),g?.(o)},[d,n,c,B,h,g]),Q=a.useMemo(()=>{if(n.length===0)return m;if(c){if(n.length>1)return r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{children:"Vários"}),r.jsx(ce,{className:"h-5 px-2 text-xs",children:n.length})]});const s=n[0];return p?`${s.value} - ${s.label}`:s.label}const e=n[0];return p?`${e.value} - ${e.label}`:e.label},[n,m,c,p]),W=a.useCallback(()=>{w(b),g?.(b),b.length>0&&h?.(b.map(e=>e.value).join(","))},[b,g,h]),X=a.useCallback(()=>{w([]),g?.([]),h?.("")},[g,h]);return r.jsxs(re,{open:T,onOpenChange:I,children:[r.jsx(te,{asChild:!0,children:r.jsxs(z,{variant:"outline",role:"combobox","aria-expanded":T,disabled:u,className:y("w-full justify-between","disabled:bg-neutral-200 disabled:cursor-not-allowed disabled:border-neutral-300","overflow-hidden",R),children:[r.jsx("span",{className:"truncate",children:Q}),r.jsx(ne,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),r.jsx(ae,{className:"w-[var(--radix-popover-trigger-width)] p-0",align:"start",children:r.jsxs(q,{shouldFilter:!1,children:[r.jsx(O,{placeholder:N,onValueChange:J,value:C}),r.jsx(E,{children:L?r.jsx("div",{className:"py-6 text-center text-sm",children:"Carregando..."}):r.jsxs(r.Fragment,{children:[r.jsx(V,{children:l}),r.jsx(ee,{children:b.map(e=>{const s=K(e.value);return r.jsxs(se,{value:e.value,onSelect:M,className:y("cursor-pointer",s&&"bg-white  hover:bg-blue-600 hover:!text-white group"),children:[r.jsx("div",{className:y("mr-2 flex h-4 w-4 items-center justify-center rounded ",c&&"border border-primary",s&&c&&"bg-black"),children:r.jsx(oe,{className:y("h-3 w-3 group-hover:!stroke-white",s?"opacity-100 ":"opacity-0 ")})}),r.jsx("span",{className:"truncate",children:p?`${e.value} - ${e.label}`:e.label})]},e.value)})})]})}),U&&c&&b.length>0&&r.jsx("div",{className:"border-t p-2",children:r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r.jsx(z,{type:"button",size:"sm",variant:"default",className:"flex-1 text-xs",onClick:W,disabled:L||n.length===b.length,children:"Selecionar Todos"}),r.jsx(z,{type:"button",size:"sm",variant:"secondary",className:"flex-1 text-xs",onClick:X,disabled:L||n.length===0,children:"Limpar"})]})})]})})]})};export{ce as B,ve as S,ie as c};
