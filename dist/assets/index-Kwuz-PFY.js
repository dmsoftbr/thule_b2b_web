import{r as a,j as e,g as b,t as m,h as g,e as A,ac as N}from"./index-C-yn2kxu.js";import{A as O}from"./app-page-header-B97b6w1v.js";import{S as B}from"./server-table-OrazAZj6.js";import{B as u}from"./index-Cj-kxx9Z.js";import{D as L,a as K,b as $,c as F,d as M,f as H}from"./dialog-o4W0LXdK.js";import{L as I}from"./label-PvIEZhsH.js";import{S as D,c as S}from"./search-combo-DoY-PKU3.js";import{T as U}from"./trash-DuwzUJ5T.js";import"./input-Dr2m_CVc.js";import"./app-tooltip-1VY1K540.js";import"./index-D5w6tM8m.js";import"./Combination-BJv6NSEb.js";import"./index-z0-V-lU6.js";import"./index-BoUYBFaC.js";import"./index-DRosYylb.js";import"./select-BqrgrOas.js";import"./index-Cap87g99.js";import"./chevron-down-lpqsW9lE.js";import"./index-Dtymrjkl.js";import"./search-8CyYJVSP.js";import"./funnel-CSCaqyL5.js";import"./loader-circle-BV1pYLGQ.js";import"./chevron-left-DklgzkMt.js";import"./chevron-right-CCWYEIpL.js";import"./index-C8Qjzrxd.js";import"./command-DF-KUbv3.js";import"./popover-D4FvDG7G.js";import"./chevrons-up-down-DXmsIWP1.js";const q=({isOpen:r,priceTableId:o,onClose:i})=>{const[d,l]=a.useState(""),[h,s]=a.useState(""),[x,f]=a.useState([]),[n,v]=a.useState([]),[y,C]=a.useState(new Date().valueOf()),[P,T]=a.useState(new Date().valueOf()),[j,p]=a.useState(!1),w=async()=>{const t={priceTableId:o,productId:d,branchId:h};try{await b.post("/registrations/price-table-products-exception",t),m.success("Excessão registrada com sucesso"),i(!0)}catch(c){m.error(g(c))}},E=async()=>{p(!0);try{const{data:t}=await b.get(`/registrations/prices/price-table/${o}`),c=S(t,"id","description",!0);f(c)}catch(t){m.error(g(t))}finally{p(!1)}},k=async()=>{p(!0);try{const{data:t}=await b.get("/registrations/branches/all"),c=S(t,"id","id",!1);v(c)}catch(t){m.error(g(t))}finally{p(!1)}};return a.useEffect(()=>{E(),k(),C(new Date().valueOf()),T(new Date().valueOf())},[r]),e.jsx(L,{open:r,onOpenChange:i,children:e.jsxs(K,{children:[e.jsxs($,{children:[e.jsx(F,{children:"Excessão de Produto na Tabela de Preço"}),e.jsx(M,{children:"Use esta opção para bloquear a venda de determinados produtos no estabelecimento informado"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx(I,{children:"Produto"}),e.jsx(D,{onChange:t=>l(t),staticItems:x,disabled:j},y),e.jsx(I,{className:"!mt-2",children:"Estabelecimento"}),e.jsx(D,{onChange:t=>s(t),staticItems:n,disabled:j},P)]}),e.jsxs(H,{children:[e.jsx(u,{variant:"green",onClick:()=>w(),children:"Adicionar"}),e.jsx(u,{variant:"secondary",onClick:()=>i(!1),children:"Cancelar"})]})]})})},z=({fnDelete:r})=>[{key:"productId",dataIndex:"productId",title:"Código do Produto"},{key:"productName",dataIndex:"productName",title:"Descrição"},{key:"branchId",dataIndex:"branchId",title:"Estabelecimento"},{key:"actions",dataIndex:"priceTableId",title:"Ações",renderItem:o=>e.jsx("div",{children:e.jsx(u,{variant:"destructive",onClick:()=>r(o),children:e.jsx(U,{className:"size-4"})})})}],ge=function(){const[o,i]=a.useState(new Date().valueOf()),[d,l]=a.useState(!1),h=A(),{priceTableId:s}=N({from:"/_app/registrations/price-tables/$priceTableId/products-exception/"}),x=()=>{l(!0)},f=n=>{console.log(n)};return e.jsxs(O,{titleSlot:`Excessão de Produtos da Tabela de Preço: ${s}`,children:[e.jsx("div",{className:"w-full px-4 mt-2",children:e.jsx(B,{onAdd:()=>x(),columns:z({fnDelete:f}),defaultSearchField:"productId",searchFields:[{id:"productId",label:"Código Longo do Produto"}],dataUrl:`/registrations/price-table-products-exception/list-paged/${s}`,additionalInfo:{priceTableId:s}},o)}),e.jsx("div",{className:"my-4 w-full px-4",children:e.jsx(u,{onClick:()=>h({to:"/registrations/price-tables"}),children:"Voltar p/Lista de Tabelas de Preço"})}),d&&e.jsx(q,{isOpen:d,onClose:n=>{n&&i(new Date().valueOf()),l(!1)},priceTableId:s})]})};export{ge as component};
