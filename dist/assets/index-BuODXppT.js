import{j as e,r as s,g as u,t as x,h as g,e as I,ac as D}from"./index-C-yn2kxu.js";import{A as S}from"./app-page-header-B97b6w1v.js";import{S as T}from"./server-table-OrazAZj6.js";import{B as d}from"./index-Cj-kxx9Z.js";import{T as C}from"./trash-DuwzUJ5T.js";import{D as E,a as y,b as w,c as A,d as k,f as B}from"./dialog-o4W0LXdK.js";import{L as N}from"./label-PvIEZhsH.js";import{S as O,c as P}from"./search-combo-DoY-PKU3.js";import"./input-Dr2m_CVc.js";import"./app-tooltip-1VY1K540.js";import"./index-D5w6tM8m.js";import"./Combination-BJv6NSEb.js";import"./index-z0-V-lU6.js";import"./index-BoUYBFaC.js";import"./index-DRosYylb.js";import"./select-BqrgrOas.js";import"./index-Cap87g99.js";import"./chevron-down-lpqsW9lE.js";import"./index-Dtymrjkl.js";import"./search-8CyYJVSP.js";import"./funnel-CSCaqyL5.js";import"./loader-circle-BV1pYLGQ.js";import"./chevron-left-DklgzkMt.js";import"./chevron-right-CCWYEIpL.js";import"./index-C8Qjzrxd.js";import"./command-DF-KUbv3.js";import"./popover-D4FvDG7G.js";import"./chevrons-up-down-DXmsIWP1.js";const L=({fnDelete:r})=>[{key:"branchId",dataIndex:"branchId",title:"Estabelecimento"},{key:"actions",dataIndex:"priceTableId",title:"Ações",renderItem:i=>e.jsx("div",{children:e.jsx(d,{variant:"destructive",onClick:()=>r(i),children:e.jsx(C,{className:"size-4"})})})}],$=({isOpen:r,priceTableId:i,onClose:o})=>{const[c,l]=s.useState(""),[m,a]=s.useState([]),[p,h]=s.useState(new Date().valueOf()),[n,f]=s.useState(!1),j=async()=>{const t={priceTableId:i,branchId:c};try{await u.post("/registrations/price-table-branches-exception",t),x.success("Excessão registrada com sucesso"),o(!0)}catch(b){x.error(g(b))}},v=async()=>{f(!0);try{const{data:t}=await u.get("/registrations/branches/all"),b=P(t,"id","id",!1);a(b)}catch(t){x.error(g(t))}finally{f(!1)}};return s.useEffect(()=>{v(),h(new Date().valueOf())},[r]),e.jsx(E,{open:r,onOpenChange:o,children:e.jsxs(y,{children:[e.jsxs(w,{children:[e.jsx(A,{children:"Excessão de Estabelecimentos na Tabela de Preço"}),e.jsx(k,{children:"Use esta opção para forçar que os produtos da tabela de preço sejam faturados por um estabelecimento da lista. Caso não tenha nenhum estabelecimento definido, todos serão permitidos."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx(N,{className:"!mt-2",children:"Estabelecimento"}),e.jsx(O,{onChange:t=>l(t),staticItems:m,disabled:n},p)]}),e.jsxs(B,{children:[e.jsx(d,{variant:"green",onClick:()=>j(),children:"Adicionar"}),e.jsx(d,{variant:"secondary",onClick:()=>o(!1),children:"Cancelar"})]})]})})},me=function(){const[i,o]=s.useState(new Date().valueOf()),[c,l]=s.useState(!1),m=I(),{priceTableId:a}=D({from:"/_app/registrations/price-tables/$priceTableId/branches-exception/"}),p=()=>{l(!0)},h=async n=>{await u.delete(`/registrations/price-table-branches-exception/${a}/${n.branchId}`),o(new Date().valueOf())};return e.jsxs(S,{titleSlot:`Excessão de Estabelecimentos da Tabela de Preço: ${a}`,children:[e.jsx("div",{className:"w-full px-4 mt-2",children:e.jsx(T,{onAdd:()=>p(),columns:L({fnDelete:h}),defaultSearchField:"branchId",searchFields:[{id:"branchId",label:"Código do Estabelecimento"}],dataUrl:`/registrations/price-table-branches-exception/list-paged/${a}`,additionalInfo:{priceTableId:a}},i)}),e.jsx("div",{className:"my-4 w-full px-4",children:e.jsx(d,{onClick:()=>m({to:"/registrations/price-tables"}),children:"Voltar p/Lista de Tabelas de Preço"})}),c&&e.jsx($,{isOpen:c,onClose:n=>{n&&o(new Date().valueOf()),l(!1)},priceTableId:a})]})};export{me as component};
