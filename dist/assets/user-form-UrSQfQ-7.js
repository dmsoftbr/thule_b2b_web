import{o as C,a8 as E,a7 as f,s as m,a9 as A,aa as D,ab as v,j as e,r as S,l as N,g as y,t as x,h as B}from"./index-C-yn2kxu.js";import{c as F,B as U}from"./index-Cj-kxx9Z.js";import{a as R,b as k,c as w,d as G,e as L,u as q,h as O,F as V}from"./form-wZZtDwF0.js";import{a as W}from"./zod-CLHPmu1F.js";import{F as d}from"./form-input-BKjCpg4m.js";import{S as $,c as z}from"./search-combo-DoY-PKU3.js";import{U as _}from"./index-yjIxugBi.js";import{F as M}from"./form-checkbox-D26YLDfI.js";import{u as T}from"./use-auth-BWk16BUZ.js";const Z=C({id:m({error:"Digite o Código do Usuário. Exemplo: luiz.silva"}).regex(/^[a-zA-Z0-9._-]+$/,"O código deve conter apenas letras, números, ponto, hífen e underscore"),name:m({error:"Digite o Nome do Usuário"}),email:D({error:"Digite um e-mail válido"}),role:A().nonempty("Selecione o Perfil do Usuário"),groupId:m({error:"Selecione um Grupo de Usuários"}),networkDomain:f(m()),customerId:f(v()),representativeId:f(v()),isActive:E()});function u({control:a,name:s,label:n,placeholder:p="",searchPlaceholder:i="",multipleSelect:t=!1,disabled:h=!1,required:o=!1,className:c="space-y-0",items:b,apiEndpoint:g,queryStringName:l,valueProp:r,labelProp:I}){return e.jsx(R,{control:a,name:s,render:({field:j})=>e.jsxs(k,{className:c,children:[e.jsx(w,{required:o,children:n}),e.jsx(G,{children:e.jsx($,{apiEndpoint:g,queryStringName:l,multipleSelect:t,searchPlaceholder:i,disabled:h,onChange:P=>j.onChange(P),defaultValue:j.value,staticItems:b,placeholder:p,valueProp:r,labelProp:I})}),e.jsx(L,{})]})})}const ae=({initialData:a,mode:s,onClose:n})=>{const{session:p}=T(),[i,t]=S.useState(!1),{showAppDialog:h}=N(),o=q({resolver:W(Z)}),c=O({control:o.control,name:"role"}),b=async l=>{try{let r={...l};t(!0),s=="ADD"?(await y.post("/admin/users",r),x.success("Usuário criado com sucesso!"),h({message:"Senha Inicial é: thule@123",title:"Atenção",type:"warning",buttons:[{text:"Fechar",variant:"secondary",value:"",autoClose:!0}]})):(await y.patch("/admin/users",r),x.success("Usuário alterado com sucesso!")),n(!0),t(!1)}catch(r){console.log(r),x.error(B(r))}finally{t(!1)}};S.useEffect(()=>{a&&o.reset(a)},[a]);const g=s=="VIEW";return e.jsx(e.Fragment,{children:e.jsx(V,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(b,l=>console.log(l)),className:"space-y-4",children:[e.jsx(d,{readOnly:s!="ADD",control:o.control,name:"id",label:"Código"}),e.jsx(d,{control:o.control,name:"name",label:"Nome"}),e.jsx(d,{label:"E-mail",control:o.control,name:"email"}),e.jsx(u,{control:o.control,items:z(_,"id","name"),label:"Perfil",name:"role",placeholder:"Selecione o Perfil do Usuário",searchPlaceholder:"Buscar Perfil"}),e.jsx(d,{label:"Domínio da Rede",control:o.control,name:"networkDomain"}),e.jsx(u,{control:o.control,apiEndpoint:"/admin/user-groups/all",queryStringName:"",labelProp:"name",valueProp:"id",label:"Grupo de Usuários",name:"groupId",placeholder:"Selecione o Grupo de Usuário",searchPlaceholder:"Buscar Grupo de Usuário"}),e.jsx(u,{className:F("hidden space-y-2",c=="3"&&"block"),control:o.control,apiEndpoint:`/registrations/customers/all/${p?.user.id}`,queryStringName:"",labelProp:"abbreviation",valueProp:"id",label:"Cliente",name:"customerId",placeholder:"Selecione o Cliente",searchPlaceholder:"Buscar Cliente"}),e.jsx(u,{className:F("hidden space-y-2",c=="2"&&"block"),control:o.control,apiEndpoint:"/registrations/representatives/all",queryStringName:"",labelProp:"abbreviation",valueProp:"id",label:"Representante",name:"representativeId",placeholder:"Selecione o Representante",searchPlaceholder:"Buscar Representante"}),e.jsx(M,{control:o.control,name:"isActive",label:"Ativo"}),e.jsxs("div",{className:"flex items-end justify-end gap-x-2",children:[!g&&e.jsx(U,{disabled:i,type:"submit",variant:"green",children:"Gravar"}),e.jsx(U,{disabled:i,type:"button",variant:"secondary",onClick:()=>n(!1),children:"Voltar p/Lista"})]})]})})})};export{ae as U};
