import{c as O,r as c,j as e,g as se,R as te}from"./index-C-yn2kxu.js";import{I as Le}from"./input-Dr2m_CVc.js";import{c as h,B as N}from"./index-Cj-kxx9Z.js";import{A as _}from"./app-tooltip-1VY1K540.js";import{C as Be,S as ae,a as le,b as re,c as ne,d as j}from"./select-BqrgrOas.js";import{u as _e}from"./index-Dtymrjkl.js";import{C as g}from"./chevron-down-lpqsW9lE.js";import{S as ge}from"./search-8CyYJVSP.js";import{F as He}from"./funnel-CSCaqyL5.js";import{L as Oe}from"./loader-circle-BV1pYLGQ.js";import{C as We}from"./chevron-left-DklgzkMt.js";import{C as H}from"./chevron-right-CCWYEIpL.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],Je=O("arrow-down-wide-narrow",qe);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],Ue=O("arrow-up-narrow-wide",Qe);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ye=O("refresh-cw",Xe),cs=({items:P,tableId:ie,columns:S,searchAutoFocus:de,dataUrl:D,dataMethod:ce="POST",showAddButton:oe=!0,addButtonContent:xe="Adicionar",defaultSortFieldDataIndex:ue,defaultSearchField:he,defaultSortDesc:me=!1,defaultPageSize:pe=10,searchFields:w,isPending:W=!1,showAdvancedFilter:je=!1,advancedFilterSlot:fe,searchSlot:be,additionalInfo:ve={},tableClassNames:Ne="",refreshDataToken:Se="",additionalButtons:ye,hideToolbar:we,searchPlaceHolder:ke="Pesquisar",rowCss:q=k=>"",groupConfig:t,onAdd:Ge,onAfterGetData:M,onSelectRow:ze,onRowDblClick:Pe})=>{const[k,Ie]=_e("",300),[f,Ee]=c.useState(pe),[T,Fe]=c.useState(he),[Re,Ae]=c.useState(""),[G,De]=c.useState(ue),[z,J]=c.useState(!me),[m,Q]=c.useState(0),[b,y]=c.useState(0),[Me,V]=c.useState(!1),[u,I]=c.useState(),[U,$]=c.useState(void 0),[X,E]=c.useState(new Set),[Y,Te]=c.useState(!1),o=(s,r)=>r.split(".").reduce((n,l)=>n&&n[l]!==void 0?n[l]:null,s),F=s=>{if(!t?.field)return{};const r=(s||[]).reduce((a,n)=>{const l=o(n,t.field)||"Sem Categoria",i=String(l);return a[i]||(a[i]=[]),a[i].push(n),a},{});return t.showEmptyGroups&&t.allPossibleGroups&&t.allPossibleGroups.forEach(a=>{const n=o(a,t.field)||"Sem Categoria",l=String(n);r[l]||(r[l]=[])}),r},Z=s=>{const r=Object.keys(s);return t?.orderBy?r.sort((a,n)=>{const l=s[a],i=s[n];let x,d;if(l.length>0)x=o(l[0],t.orderBy);else if(t.allPossibleGroups){const p=t.allPossibleGroups.find(L=>{const B=o(L,t.field)||"Sem Categoria";return String(B)===a});x=p?o(p,t.orderBy):null}if(i.length>0)d=o(i[0],t.orderBy);else if(t.allPossibleGroups){const p=t.allPossibleGroups.find(L=>{const B=o(L,t.field)||"Sem Categoria";return String(B)===n});d=p?o(p,t.orderBy):null}if(x===null&&d===null)return a.localeCompare(n);if(x===null)return 1;if(d===null)return-1;if(typeof x=="number"&&typeof d=="number"){const p=x-d;return t.orderDirection==="desc"?-p:p}const v=String(x).toLowerCase(),A=String(d).toLowerCase();return v<A?t.orderDirection==="desc"?1:-1:v>A?t.orderDirection==="desc"?-1:1:0}):r.sort()},C=s=>{E(r=>{const a=new Set(r);return a.has(s)?a.delete(s):a.add(s),a})},K=s=>{if(s&&u?.result){const r=F(u.result);E(new Set(Object.keys(r)))}else E(new Set)};c.useEffect(()=>{if(t?.defaultExpanded&&u?.result){const s=F(u.result);E(new Set(Object.keys(s)))}},[u,t]);const ee=s=>{let r=m;s=="next"&&m+1==b||s=="previous"&&m==0||(s=="next"&&r++,s=="previous"&&r--,Q(r))},R=async()=>{try{if(V(!0),!D){I({result:[],totalRecords:0}),P&&I({result:P,totalRecords:P.length}),M?.([]);return}if(ce=="POST"){let{data:s}=await se.post(D,{currentPage:m,pageSize:f,searchField:T,searchText:k,sortField:G,sortAsc:z,customWhere:Re,...ve});Array.isArray(s)&&(s={result:s,totalRecords:s.length}),s.result==null&&(s.result=[]),I(s),M?.(s.result),f>0?(y(Math.ceil(s.totalRecords/f)),s.totalRecords==0&&y(1)):y(1)}else{const{data:s}=await se.get(D);s.result==null&&(s.result=[]),I(s),M?.(s.result),f>0?(y(Math.ceil(s.totalRecords/f)),s.totalRecords==0&&y(1)):y(1)}}catch(s){console.log(s)}finally{V(!1)}},Ve=()=>{Q(0),setTimeout(()=>{},250),R()};c.useEffect(()=>{Ve()},[k]),c.useEffect(()=>{R()},[P,m,f,z,G,T]),c.useEffect(()=>{V(W)},[W]),c.useEffect(()=>{R()},[Se]);const $e=()=>{if(!u?.result||u.result.length===0){if(t?.showEmptyGroups&&t?.allPossibleGroups){const a=F([]);return Z(a).map(l=>{const i=a[l],x=X.has(l);return e.jsx(te.Fragment,{children:e.jsx("tr",{className:"bg-neutral-200 hover:bg-neutral-300 cursor-pointer border-b-2 border-neutral-400",onClick:()=>C(l),children:e.jsx("td",{colSpan:S.length,className:"border px-2 py-3 font-semibold text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[x?e.jsx(g,{className:"size-4 text-neutral-600"}):e.jsx(H,{className:"size-4 text-neutral-600"}),e.jsx(e.Fragment,{children:t.renderGroupHeader?t.renderGroupHeader(l,i,t.idField&&t.allPossibleGroups?(()=>{const d=t.allPossibleGroups.find(v=>{const A=o(v,t.field)||"Sem Categoria";return String(A)===l});return d?o(d,t.idField):void 0})():void 0):`${t.label||t.field}: ${l} (${i.length})`})]})})})},`empty-group-${l}`)})}return e.jsx("tr",{children:e.jsx("td",{className:"text-center p-4 border",colSpan:S.length,children:"Sem dados para exibir"})})}if(!t?.field)return u.result.map((a,n)=>e.jsx("tr",{className:h("even:bg-neutral-100 hover:bg-neutral-50 cursor-pointer",U==a?"!bg-primary/30 ":"",q?.(a)),onDoubleClick:l=>{$(a),Pe?.(a),l.preventDefault()},onClick:l=>{$(a),ze?.(a),l.preventDefault()},children:S.map((l,i)=>e.jsx("td",{className:h("border px-1.5 py-2 text-sm break-words break-all",l.cellClassName),children:l.renderItem?l.renderItem(a):a[l.dataIndex]},i))},n));const s=F(u.result);return Z(s).map(a=>{const n=s[a],l=X.has(a);return e.jsxs(te.Fragment,{children:[e.jsx("tr",{className:"bg-neutral-200 hover:bg-neutral-300 cursor-pointer border-b-2 border-neutral-400",onClick:()=>C(a),children:e.jsx("td",{colSpan:S.length,className:"border px-2 py-3 font-semibold text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[l?e.jsx(g,{className:"size-4 text-neutral-600"}):e.jsx(H,{className:"size-4 text-neutral-600"}),e.jsx("span",{className:"w-full",children:t.renderGroupHeader?t.renderGroupHeader(a,n,n.length>0?t.idField?o(n[0],t.idField):void 0:t.allPossibleGroups&&t.idField?(()=>{const i=t.allPossibleGroups.find(x=>{const d=o(x,t.field)||"Sem Categoria";return String(d)===a});return i?o(i,t.idField):void 0})():void 0):`${t.label||t.field}: ${a} (${n.length})`})]})})}),l&&n.map((i,x)=>e.jsx("tr",{className:h("even:bg-neutral-50 odd:bg-white hover:bg-neutral-100 cursor-pointer",U==i?"!bg-primary/30":"",q?.(i)),onClick:d=>{$(i),d.preventDefault()},children:S.map((d,v)=>e.jsx("td",{className:h("border px-1.5 py-2 text-sm break-words break-all",d.cellClassName,v===0&&"pl-8"),children:d.renderItem?d.renderItem(i):i[d.dataIndex]},v))},`${a}-${x}`))]},`group-${a}`)})};return e.jsxs("div",{className:"w-full relative min-h-full",children:[e.jsxs("div",{className:h("flex flex-col w-full",we&&"hidden"),children:[e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap gap-y-1.5 items-center justify-between gap-x-2",children:[e.jsx(_,{message:"Atualizar Lista",children:e.jsx(N,{size:"sm",className:"h-9",type:"button",onClick:R,children:e.jsx(Ye,{className:"size-4"})})}),t?.field&&(u?.result&&u.result.length>0||t.allPossibleGroups)&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(_,{message:"Expandir Todos",children:e.jsx(N,{size:"sm",variant:"outline",className:"h-9 px-2",type:"button",onClick:()=>K(!0),children:e.jsx(g,{className:"size-4"})})}),e.jsx(_,{message:"Recolher Todos",children:e.jsx(N,{size:"sm",variant:"outline",className:"h-9 px-2",type:"button",onClick:()=>K(!1),children:e.jsx(Be,{className:"size-4"})})})]}),e.jsx("div",{children:be}),w.length>0&&e.jsxs(ae,{onValueChange:s=>{Fe(s);const r=w.find(a=>a.id==s);Ae(r?.customWhere??"")},value:T,children:[e.jsx(le,{className:"flex-1",children:e.jsx(re,{})}),e.jsx(ne,{children:w&&w.length>0&&w.map((s,r)=>e.jsx(j,{value:s.id,children:s.label},r))})]}),e.jsxs("div",{className:"relative flex items-center justify-center w-full",children:[e.jsx("div",{className:"absolute left-3 select-none text-neutral-600",children:e.jsx(ge,{className:"size-3"})}),e.jsx(Le,{placeholder:ke,defaultValue:k,onChange:s=>Ie(s.target.value),className:h(k&&"bg-yellow-50","pl-8"),type:"search",autoFocus:de})]}),e.jsxs("div",{className:"flex gap-x-2",children:[ye,oe&&e.jsx(N,{type:"button",onClick:()=>{Ge?.()},className:"w-full md:w-fit",children:xe}),je&&e.jsx(N,{type:"button",onClick:()=>{Te(!Y)},className:"w-full md:w-fit",children:e.jsx(He,{className:"size-4"})})]})]}),Y&&e.jsx(e.Fragment,{children:fe})]}),Me&&e.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-neutral-800 opacity-30"}),e.jsxs("div",{className:"p-8 w-52 h-20 flex items-center justify-center rounded-md bg-white z-50",children:[e.jsx("span",{children:e.jsx(Oe,{className:"size-4 animate-spin mr-1"})}),"Aguarde..."]})]}),e.jsx("div",{className:"rounded-t-md mt-2 overflow-hidden",children:e.jsxs("table",{id:ie,className:h("w-full table-fixed",Ne),children:[e.jsx("thead",{children:e.jsx("tr",{children:S.map(s=>e.jsxs("th",{className:h("border border-neutral-300 text-sm h-8 text-left font-semibold bg-neutral-200",s.className),children:[!s.sortable&&e.jsx("span",{className:"p-1",children:s.title}),s.sortable&&e.jsxs("div",{className:h("flex items-center justify-between p-1 h-full w-full cursor-pointer",s.dataIndex==G&&"bg-neutral-300",s.sortable&&"hover:bg-neutral-400/45"),children:[e.jsx("div",{className:"w-full",role:"button",onClick:()=>{G==s.dataIndex?J(!z):(De(s.dataIndex),J(!0))},children:s.title}),G==s.dataIndex&&e.jsxs("span",{children:[z&&e.jsx(Ue,{className:"size-3"}),!z&&e.jsx(Je,{className:"size-3"})]})]})]},s.key))})}),e.jsx("tbody",{children:$e()})]})}),e.jsxs("div",{className:"mt-1 flex justify-between",children:[e.jsxs("div",{className:"text-xs flex items-center gap-x-1",children:["Exibir:",e.jsxs(ae,{onValueChange:s=>Ee(parseInt(s)),value:f.toString(),children:[e.jsx(le,{className:"text-xs",children:e.jsx(re,{placeholder:""})}),e.jsxs(ne,{children:[e.jsx(j,{className:"text-xs",value:"0",children:"Todos"}),e.jsx(j,{className:"text-xs",value:"6",children:"6"}),e.jsx(j,{className:"text-xs",value:"8",children:"8"}),e.jsx(j,{className:"text-xs",value:"10",children:"10"}),e.jsx(j,{className:"text-xs",value:"25",children:"25"}),e.jsx(j,{className:"text-xs",value:"50",children:"50"}),e.jsx(j,{className:"text-xs",value:"100",children:"100"})]})]}),e.jsxs("span",{className:"hidden md:block ml-1 text-xs",children:["Total de Registros: ",u?.totalRecords]})]}),e.jsxs("div",{className:"flex items-center gap-x-2 justify-end text-xs",children:["PÃ¡gina: ",m+1," / ",b==0?1:b,e.jsx(N,{size:"sm",variant:"secondary",onClick:()=>ee("previous"),disabled:(b==0||b==1)&&m==0,children:e.jsx(We,{className:"size-4"})}),e.jsx(N,{size:"sm",variant:"secondary",onClick:()=>ee("next"),disabled:(b==0||b==1)&&m==0,children:e.jsx(H,{className:"size-4"})})]})]})]})};export{Je as A,Ye as R,cs as S,Ue as a};
